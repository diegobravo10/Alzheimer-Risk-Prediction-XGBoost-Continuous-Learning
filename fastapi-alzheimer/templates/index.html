<!DOCTYPE html>
<html>
<head>
<title>Alzheimer Risk Predictor</title>
<link rel="stylesheet" href="/static/style.css">
</head>

<body>

{% if request.query_params.msg %}
<div class="notification">
  {{ request.query_params.msg }}
</div>
{% endif %}

{% if msg %}
<div class="notification">
  {{ msg }}
</div>
{% endif %}

{% if result %}
<div class="result">
  <strong>{{ result }}</strong><br>
  <small>Probabilidad: {{ confidence }}%</small><br>
  <em>{{ advice }}</em>
</div>
{% endif %}
<!--
{% if result and not confirmed %}
<form action="/confirm" method="post" class="confirm-box">
  <input type="hidden" name="X_prep" value="{{ X_prep }}">
  <input type="hidden" name="predicted_label" value="{{ predicted_label }}">

  <small>¬øEl diagn√≥stico fue correcto?</small><br>

  <button type="submit" name="action" value="correct" class="confirm-btn">
    ‚úî Correcto
  </button>

  <details style="margin-top:8px;">
    <summary style="cursor:pointer;">‚úñ Incorrecto</summary>

    <label style="display:block;margin-top:8px;">
      Seleccione el diagn√≥stico real:
      <select name="true_label">
        <option value="0">0 - Bajo riesgo</option>
        <option value="1">1 - Alto riesgo</option>
      </select>
    </label>

    <button type="submit" name="action" value="incorrect"
            class="confirm-btn" style="margin-top:8px;">
      Guardar correcci√≥n
    </button>
  </details>
</form>
{% endif %}
-->
<div class="card">
<h2>üß† Evaluaci√≥n de Riesgo de Alzheimer</h2>

<form action="/predict" method="post">

<!-- DEMOGRAF√çA -->
<div class="section">
<h3>üë§ Datos Demogr√°ficos</h3>
<div class="grid">

<label>Edad
<input type="number" name="Age" value="{{ form_data.Age }}" min="40" max="120" required>
<small>Edad en a√±os (ej: 72)</small>
</label>

<label>G√©nero
<select name="Gender">
<option value="0" {% if form_data.Gender == 0 %}selected{% endif %}>Masculino</option>
<option value="1" {% if form_data.Gender == 1 %}selected{% endif %}>Femenino</option>
</select>
<small>Seleccione el sexo biol√≥gico</small>
</label>

<label>Etnia
<br>
<select name="Ethnicity">
<option value="0" {% if form_data.Ethnicity == 0 %}selected{% endif %}>Cauc√°sico</option>
<option value="1" {% if form_data.Ethnicity == 1 %}selected{% endif %}>Afroamericano</option>
<option value="2" {% if form_data.Ethnicity == 2 %}selected{% endif %}>Asi√°tico</option>
<option value="3" {% if form_data.Ethnicity == 3 %}selected{% endif %}>Otro</option>
</select>
<br>
<small>Grupo √©tnico del paciente</small>
</label>

<label>Nivel Educaci√≥n
<select name="EducationLevel">
<option value="0" {% if form_data.EducationLevel == 0 %}selected{% endif %}>Sin estudios</option>
<option value="1" {% if form_data.EducationLevel == 1 %}selected{% endif %}>Secundaria</option>
<option value="2" {% if form_data.EducationLevel == 2 %}selected{% endif %}>Universidad</option>
<option value="3" {% if form_data.EducationLevel == 3 %}selected{% endif %}>Superior</option>
</select>
<br>
<small>Nivel acad√©mico alcanzado</small>
</label>

</div>
</div>

<!-- ESTILO VIDA -->
<div class="section">
<h3>üèÉ Estilo de Vida</h3>
<div class="grid">

<label>BMI
<input type="number" name="BMI" value="{{ form_data.BMI }}" step="0.1" min="15" max="40" required>
<small>√çndice de masa corporal (15-40)</small>
</label>

<label>Alcohol
<input name="AlcoholConsumption" value="{{ form_data.AlcoholConsumption }}"
min="0" max="20" required>
<br>
<small>
Unidades est√°ndar por semana (0‚Äì20).
1 unidad ‚âà 1 cerveza (330 ml), 1 copa de vino o 1 shot.
</small>
</label>

<label>Actividad F√≠sica
<input type="number" name="PhysicalActivity" value="{{ form_data.PhysicalActivity }}" min="0" max="10" required>
<small>Horas por semana (0 = nada, 10 = muy activo)</small>
</label>

<label>Dieta
<input type="number" name="DietQuality" value="{{ form_data.DietQuality }}" min="0" max="10" required>
<small>Calidad dieta (0 mala ‚Äî 10 excelente)</small>
</label>

<label>Sue√±o
<input type="number" name="SleepQuality" value="{{ form_data.SleepQuality }}" min="4" max="10" required>
<small>Calidad sue√±o (4 mala ‚Äî 10 excelente)</small>
</label>

</div>
</div>

<!-- HISTORIAL -->
<div class="section">
<h3>ü©∫ Historial M√©dico</h3>
<div class="checkgrid">

<label><input type="checkbox" name="Smoking" {% if form_data.Smoking %}checked{% endif %}> Fumador
<small>Marcar si fuma actualmente</small></label>

<label><input type="checkbox" name="FamilyHistoryAlzheimers" {% if form_data.FamilyHistoryAlzheimers %}checked{% endif %}> Familiar Alzheimer
<small>Antecedentes familiares</small></label>

<label><input type="checkbox" name="CardiovascularDisease" {% if form_data.CardiovascularDisease %}checked{% endif %}> Cardiovascular</label>
<label><input type="checkbox" name="Diabetes" {% if form_data.Diabetes %}checked{% endif %}> Diabetes</label>
<label><input type="checkbox" name="Depression" {% if form_data.Depression %}checked{% endif %}> Depresi√≥n</label>
<label><input type="checkbox" name="HeadInjury" {% if form_data.HeadInjury %}checked{% endif %}> Trauma craneal</label>
<label><input type="checkbox" name="Hypertension" {% if form_data.Hypertension %}checked{% endif %}> Hipertensi√≥n</label>

</div>
</div>

<!-- CL√çNICOS -->
<div class="section">
<h3>üìä Mediciones Cl√≠nicas</h3>
<div class="grid">

<label>Presi√≥n Sist√≥lica
<input type="number" name="SystolicBP" value="{{ form_data.SystolicBP }}" min="90" max="181" required>
<small>mmHg (90‚Äì180 t√≠pico)</small>
</label>

<label>Presi√≥n Diast√≥lica
<input type="number" name="DiastolicBP" value="{{ form_data.DiastolicBP }}" min="60" max="121" required>
<small>mmHg (60‚Äì120 t√≠pico)</small>
</label>

<label>Colesterol Total
<input type="number" name="CholesterolTotal" value="{{ form_data.CholesterolTotal }}" min="150" max="301">
<br>
<small>150‚Äì300 mg/dL</small>
</label>

<label>LDL
<input type="number" name="CholesterolLDL" value="{{ form_data.CholesterolLDL }}" min="50" max="200">
<br>
<small>50‚Äì200 mg/dL</small>
</label>

<label>HDL
<input type="number" name="CholesterolHDL" value="{{ form_data.CholesterolHDL }}" min="20" max="100">
<br>
<small>20‚Äì100 mg/dL</small>
</label>

<label>Triglic√©ridos
<input type="number" name="CholesterolTriglycerides" value="{{ form_data.CholesterolTriglycerides }}" min="50" max="400">
<br>
<small>50‚Äì400 mg/dL</small>
</label>

</div>
</div>

<!-- COGNITIVO -->
<div class="section">
<h3>üß† Evaluaci√≥n Cognitiva</h3>
<div class="grid">

<label>MMSE
<input type="number" name="MMSE" value="{{ form_data.MMSE }}" min="0" max="30" required>
<br>
<small>0‚Äì30 (menor = mayor deterioro)</small>
</label>

<label>Evaluaci√≥n Funcional
<input type="number" name="FunctionalAssessment" value="{{ form_data.FunctionalAssessment }}" min="0" max="10" required>
<br>
<small>0‚Äì10 (menor = mayor limitaci√≥n)</small>
</label>

<label>ADL
<input type="number" name="ADL" value="{{ form_data.ADL }}" min="0" max="10" required>
<br>
<small>0‚Äì10 (menor = m√°s dependencia)</small>
</label>

</div>
</div>

<!-- S√çNTOMAS -->
<div class="section">
<h3>‚ö†Ô∏è S√≠ntomas</h3>
<div class="checkgrid">

<label><input type="checkbox" name="MemoryComplaints" {% if form_data.MemoryComplaints %}checked{% endif %}> Quejas memoria</label>
<label><input type="checkbox" name="BehavioralProblems" {% if form_data.BehavioralProblems %}checked{% endif %}> Problemas de Conducta</label>
<label><input type="checkbox" name="Confusion" {% if form_data.Confusion %}checked{% endif %}> Confusi√≥n</label>
<label><input type="checkbox" name="Disorientation" {% if form_data.Disorientation %}checked{% endif %}> Desorientaci√≥n</label>
<label><input type="checkbox" name="PersonalityChanges" {% if form_data.PersonalityChanges %}checked{% endif %}> Cambios personalidad</label>
<label><input type="checkbox" name="DifficultyCompletingTasks" {% if form_data.DifficultyCompletingTasks %}checked{% endif %}> Dificultad tareas</label>
<label><input type="checkbox" name="Forgetfulness" {% if form_data.Forgetfulness %}checked{% endif %}> Olvidos</label>

</div>
</div>

<button type="submit">Evaluar Riesgo</button>

</form>
</div>

<script>
// Enfocar y scrollear al primer campo inv√°lido para mejorar la UX
document.querySelector('form').addEventListener('submit', function(e){
  if(!this.checkValidity()){
    // Dejar que el navegador muestre mensajes de validaci√≥n
    const firstInvalid = this.querySelector(':invalid');
    if(firstInvalid){
      firstInvalid.scrollIntoView({behavior:'smooth', block:'center'});
      firstInvalid.focus();
    }
    // No evitar env√≠o porque queremos que el navegador muestre el mensaje
  }
});
</script>

</body>
</html>
